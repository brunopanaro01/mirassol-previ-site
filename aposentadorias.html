<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Aposentadorias | Mirassol‑Previ</title>
<style>
:root{ --prim:#014c85; --borda:#e5e7eb; --muted:#64748b; --bg:#ffffff; --sidebar:#f9fafb; }
*{box-sizing:border-box;margin:0;padding:0}
html, body{height:100%; overflow:hidden; font-family:Arial, Helvetica, sans-serif; color:#0f172a; background:var(--bg);}
header{background:var(--prim);color:#fff;text-align:center;padding:12px 8px;flex:0 0 auto}
header img{height:56px}
.app{display:flex;flex-direction:column;height:100%}
.main{display:grid;grid-template-columns:280px 1fr;gap:0;flex:1 1 auto;min-height:0}
/* Sidebar */
.sidebar{border-right:1px solid var(--borda);background:var(--sidebar);display:flex;flex-direction:column;min-height:0}
.sidebar-header{padding:10px 14px;font-size:17px;color:#fff;background:#014c85;border-bottom:1px solid var(--borda);flex:0 0 auto}
.sidebar-note{padding:6px 14px;font-size:12px;color:#334155;background:#f6f7fb;border-bottom:1px solid #eaeef3}
.sidebar-scroll{overflow:auto;flex:1 1 auto;padding:6px 0}
.menu-item{margin-bottom:6px}
.menu-btn{width:100%;text-align:left;border:none;background:#fff;padding:10px 12px;font-size:14px;font-weight:bold;cursor:pointer;border-top:1px solid var(--borda)}
.menu-btn.active{background:#014c85;color:#fff}
/* Content */
.content{display:flex;flex-direction:column;min-width:0;min-height:0}
.toolbar{padding:8px 12px;border-bottom:1px solid var(--borda);background:#f8fafc;color:#014c85;font-weight:bold;font-size:14px;flex:0 0 auto}
.viewer{flex:1 1 auto;min-height:0;overflow:auto;padding:16px}
.section{max-width:1100px;margin:0 auto}
.card{ background:#fff; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,.06); overflow:hidden; border:1px solid var(--borda) }
.card-pad{ padding:16px }
h1{font-size:22px;color:#014c85;margin:0 0 8px}
h2{color:#014c85;margin:16px 0 8px}
.lead{line-height:1.55}
.lgpd{ font-size:13px; color:#475569; margin:6px 0 14px }
/* Regras */
.accordion { width:100%; }
.accordion-item { background: #fff; border-top:1px solid var(--borda) }
.accordion-item:first-child{border-top:0}
.accordion-header {
  background-color: #014c85; color: #fff; padding: 15px 20px;
  cursor: pointer; position: relative; font-weight: bold;
}
.accordion-header::after {
  content: "+"; position: absolute; right: 20px; top: 50%; transform: translateY(-50%);
  font-size: 20px; transition: transform 0.3s ease;
}
.accordion-header.active::after { transform: translateY(-50%) rotate(45deg); }
.accordion-content {
  max-height: 0; overflow: hidden; transition: max-height 0.35s ease;
  padding: 0 20px; background: #fafafa;
}
.accordion-content p, .accordion-content table { margin: 15px 0; font-size: 14px; line-height: 1.5; }
.accordion-content table { width: 100%; border-collapse: collapse; background:#fff }
.accordion-content th, .accordion-content td {
  border: 1px solid #ccc; padding: 8px; text-align: center;
}
/* Benefício Concedido */
.ano { border-top:1px solid var(--borda); margin-top:8px }
.ano-btn{
  width:100%; text-align:left; background:#f8fafc; border:none; padding:12px 16px;
  font-weight:bold; cursor:pointer; display:flex; align-items:center; justify-content:space-between;
}
.ano-btn span{ color:#0f172a }
.ano-btn i{ color:#475569 }
.ano-conteudo{ display:none; padding:0 12px 12px 12px; background:#fff }
.tabela{ width:100%; border-collapse: collapse; margin-top:10px; background:#fff }
.tabela th, .tabela td{ border:1px solid #dfe3e8; padding:8px; font-size:14px; text-align:left }
.tabela th{ background:#eef2f7 }
.tabela td:last-child a{ color:var(--prim); text-decoration:none; font-weight:bold }
.tabela td:last-child a:hover{ text-decoration:underline }
/* Memórias */
.table{width:100%;border-collapse:collapse;margin-top:10px;background:#fff}
.table th,.table td{border:1px solid var(--borda);padding:10px;text-align:left;vertical-align:top}
.table th{background:#f3f6fb;color:#0f172a}
.table a{color:#014c85;text-decoration:none}
.table a:hover{text-decoration:underline}
/* Footer */
.footer{flex:0 0 auto;border-top:1px solid var(--borda);padding:10px 0;background:#fff}
.back-btn{display:block;margin:0 auto;padding:8px 14px;background:#014c85;color:white;border-radius:6px;text-decoration:none;width:fit-content}
.back-btn:hover{background:#003f6d}
@media (max-width: 900px){
  .main{grid-template-columns:1fr}
}

/* Cabeçalho centralizado com brasão linkando para a página inicial */
.topo{
  background:var(--prim);
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:10px 12px;
}
.topo .brand{
  display:flex;
  align-items:center;
  gap:10px;
  text-decoration:none;
  color:#fff;
}
.topo img{ height:56px; display:block; }
.topo .titles h1{ margin:0; font-size:22px; }
.topo .titles p{ margin:0; font-size:13px; }

/* Espaçamento dos botões de anos no Benefício Concedido */
.years{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  margin:10px 0 16px;
}
.year-btn{
  padding:8px 12px;
  border:1px solid var(--borda);
  border-radius:8px;
  background:#fff;
  cursor:pointer;
  font-size:14px;
}
.year-btn.active{
  background:var(--prim);
  color:#fff;
  border-color:var(--prim);
}

</style>
</head>
<body>
<div class="app">
  <header class="topo">
  <a href="index.html" class="brand">
    <img src="brasao.png" alt="Brasão">
    <div class="titles">
      <h1>Mirassol‑Previ</h1>
      <p>Fundo Municipal de Previdência Social</p>
    </div>
  </a>
</header>

  <div class="main">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">Aposentadorias</div>
      <div class="sidebar-note">Obs.: Arquivos externos abrirão em nova aba.</div>
      <div class="sidebar-scroll">
        <div class="menu-item"><button class="menu-btn active" data-section="regras">Regras de Aposentadoria</button></div>
        <div class="menu-item"><button class="menu-btn" data-section="beneficio">Benefício Concedido</button></div>
        <div class="menu-item"><button class="menu-btn" data-section="memorias">Memórias</button></div>
      </div>
    </aside>

    <!-- Content -->
    <main class="content">
      <div class="toolbar" id="viewTitle">Regras de Aposentadoria</div>
      <div class="viewer">
        <div class="section">

          <!-- Regras -->
          <section id="sec-regras" class="card">
            <div class="card-pad">
              <div class="lgpd">Em atenção à LGPD, documentos externos (quando houver) abrirão em <strong>nova aba</strong>.</div>
              <div class="accordion">
                <div class="accordion-item">
                  <div class="accordion-header">1ª Regra – Idade e Tempo de Contribuição</div>
                  <div class="accordion-content">
                    <p><strong>Aplicável:</strong> Servidores ingressados após 31/12/2003, ou que não optaram pelas regras de transição.</p>
                    <p><strong>Regra permanente (Art. 40, §1º, III, a):</strong></p>
                    <table>
                      <tr><th>Requisito</th><th>Homem</th><th>Mulher</th></tr>
                      <tr><td>Tempo contribuição</td><td>35 anos</td><td>30 anos</td></tr>
                      <tr><td>Idade mínima</td><td>60 anos</td><td>55 anos</td></tr>
                      <tr><td>Tempo no serviço</td><td>10 anos</td><td>10 anos</td></tr>
                      <tr><td>Tempo no cargo</td><td>5 anos</td><td>5 anos</td></tr>
                    </table>
                    <p><strong>Cálculo:</strong> média da Lei 10.887/2004; teto = remuneração do cargo efetivo; sem paridade.</p>
                    <p><strong>Reajuste:</strong> Não tem paridade; segue índices/data do RGPS.</p>
                  </div>
                </div>
                <div class="accordion-item">
                  <div class="accordion-header">2ª Regra – Direito Adquirido</div>
                  <div class="accordion-content">
                    <p>Para quem cumpriu os requisitos de aposentadoria até 31/12/2003, valem as regras anteriores à EC nº 41/2003, com paridade e integralidade.</p>
                  </div>
                </div>
                <div class="accordion-item">
                  <div class="accordion-header">3ª Regra – Transição EC 41/2003</div>
                  <div class="accordion-content">
                    <p>Para ingressados até 31/12/2003 que não completaram os requisitos à época. Prevê pedágio de 20% sobre o tempo faltante; garante paridade e integralidade.</p>
                  </div>
                </div>
                <div class="accordion-item">
                  <div class="accordion-header">4ª Regra – Aposentadoria Compulsória</div>
                  <div class="accordion-content">
                    <p><strong>Base legal:</strong> LC nº 152/2015 - Art. 40, §1º, CF</p>
                    <p><strong>Idade mínima:</strong> 75 anos. Proventos proporcionais ao tempo de contribuição.</p>
                  </div>
                </div>
              </div>
            </div>
          </section>

          
          <!-- Benefício Concedido (dinâmico via beneficios.json) -->
          <section id="sec-beneficio" class="card" style="display:none">
            <div class="card-pad">
              <h2 style="margin:0 0 6px">Benefício Concedido</h2>
              <p class="lgpd" style="margin-top:0">
                Distribuído por <strong>ano</strong>, com colunas: <em>Mês</em>, <em>Descrição</em> e <em>Arquivo</em> (abre em nova aba).
              </p>
              <div id="benef-container">
                <div class="empty">Carregando dados…</div>
              </div>
            </div>
          </section>


          <!-- Memórias -->
<section id="sec-memorias" class="card" style="display:none">
  <div class="card-pad">
    <h1>Memórias</h1>
    <p class="lead">
      O projeto tem como objetivo relacionar relatos orais e documentais dos servidores aposentados que fizeram parte do quadro de servidores do município de Mirassol D’Oeste - MT que em sua grande maioria se mistura com a história do município por meio de relatos, fotos, imagens, desenhos e fotografias antigas de que tenham posse visando demonstrar o fazer docente.
    </p>
    <p class="lead">
      As recordações pessoais dos profissionais buscam reconstruir a história do município além de recontar as memórias afetivas que se fizeram presentes ao longo dos anos.
    </p>
    <h2>Acervo (relatos & arquivos)</h2>
    <p class="lgpd">
      Os arquivos de relatos, fotos e documentos são disponibilizados mediante autorização dos participantes. 
      Ao clicar, o arquivo abre em <strong>nova aba</strong>.
    </p>

    <table class="table" id="tabelaMemorias">
      <thead>
        <tr>
          <th style="width:65%;">Descrição</th>
          <th>Arquivo</th>
        </tr>
      </thead>
      <tbody>
        <tr><td colspan="2">Carregando...</td></tr>
      </tbody>
    </table>
  </div>
</section>

<script>
  // Carregar os dados de memorias.json
  fetch('memorias.json')
    .then(response => {
      if (!response.ok) {
        throw new Error("Erro ao carregar o arquivo memorias.json");
      }
      return response.json();
    })
    .then(data => {
      const tbody = document.querySelector("#tabelaMemorias tbody");
      tbody.innerHTML = ""; // limpar linha de "Carregando..."

      if (data.length === 0) {
        tbody.innerHTML = "<tr><td colspan='2'>Nenhum item cadastrado ainda.</td></tr>";
        return;
      }

      data.forEach(item => {
        const tr = document.createElement("tr");

        const tdDesc = document.createElement("td");
        tdDesc.textContent = item.descricao;

        const tdLink = document.createElement("td");
        const link = document.createElement("a");
        link.href = item.link;
        link.target = "_blank";
        link.textContent = "Baixar arquivo";
        tdLink.appendChild(link);

        tr.appendChild(tdDesc);
        tr.appendChild(tdLink);
        tbody.appendChild(tr);
      });
    })
    .catch(error => {
      console.error(error);
      const tbody = document.querySelector("#tabelaMemorias tbody");
      tbody.innerHTML = "<tr><td colspan='2'>Erro ao carregar os dados.</td></tr>";
    });
</script>

        </div>
      </div>
      <div class="footer">
        <a href="index.html" class="back-btn">← Voltar</a>
      </div>
    </main>
  </div>
</div>

<script>
// Menu lateral: alternar seções
const buttons = document.querySelectorAll('.menu-btn');
const titleEl = document.getElementById('viewTitle');
buttons.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    buttons.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    const sec = btn.dataset.section; // 'regras' | 'beneficio' | 'memorias'
    titleEl.textContent = (sec==='regras' ? 'Regras de Aposentadoria' : (sec==='beneficio' ? 'Benefício Concedido' : 'Memórias'));
    document.getElementById('sec-regras').style.display = (sec==='regras')?'':'none';
    document.getElementById('sec-beneficio').style.display = (sec==='beneficio')?'':'none';
    document.getElementById('sec-memorias').style.display = (sec==='memorias')?'':'none';
  });
});

// Acordeão das regras
document.querySelectorAll('.accordion-header').forEach(header => {
  header.addEventListener('click', () => {
    const content = header.nextElementSibling;
    header.classList.toggle('active');
    if (content.style.maxHeight) content.style.maxHeight = null;
    else content.style.maxHeight = content.scrollHeight + 'px';
  });
});

// Acordeão por ANO (Benefício Concedido)
document.querySelectorAll('.ano-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    const ano = btn.getAttribute('data-ano');
    const el = document.getElementById('ano-'+ano);
    const aberto = el.style.display === 'block';
    document.querySelectorAll('.ano-conteudo').forEach(x=>x.style.display='none');
    document.querySelectorAll('.ano-btn i').forEach(i=>i.textContent='abrir');
    if(!aberto){ el.style.display = 'block'; btn.querySelector('i').textContent = 'fechar'; }
  });
});

// Carregar itens de memorias.json, se existir (para preencher a tabela automaticamente)
async function carregarMemorias(){
  try{
    const res = await fetch('memorias.json', {cache:'no-store'});
    if(!res.ok) return;
    const dados = await res.json();
    const corpo = document.querySelector('#tabelaMemorias tbody');
    if(!Array.isArray(dados) || dados.length===0){
      corpo.innerHTML = '<tr><td colspan="2">Nenhum item cadastrado ainda.</td></tr>';
      return;
    }
    corpo.innerHTML = dados.map(item => `
      <tr>
        <td>${item.descricao || ''}</td>
        <td>${item.link ? `<a href="${item.link}" target="_blank" rel="noopener">Baixar arquivo</a>` : '-'}</td>
      </tr>
    `).join('');
  }catch(e){
    // mantém a mensagem padrão caso o JSON não exista
  }
}
carregarMemorias();


// ===== BENEFÍCIO CONCEDIDO (dinâmico a partir de beneficios.json) =====
let BENEF = null;

function tableBenef(rows){
  if(!rows || rows.length===0){
    return '<div class="empty">Nenhum registro neste ano.</div>';
  }
  return `
    <table class="tabela">
      <thead><tr><th style="width:120px">Mês</th><th>Descrição</th><th style="width:180px">Arquivo</th></tr></thead>
      <tbody>
        ${rows.map(r=>`
          <tr>
            <td>${r.mes || ''}</td>
            <td>${r.descricao || ''}</td>
            <td>${r.link ? `<a href="${r.link}" target="_blank" rel="noopener">Baixar arquivo</a>` : '-'}</td>
          </tr>
        `).join('')}
      </tbody>
    </table>
  `;
}
function renderBenefYears(){
  const container = document.getElementById('benef-container');
  const years = Object.keys(BENEF || {}).sort();
  if(years.length===0){
    container.innerHTML = '<div class="empty">Não há anos cadastrados no <code>beneficios.json</code>.</div>';
    return;
  }
  const last = years[years.length-1];
  container.innerHTML = `
    <h2>Selecione o ano</h2>
    <div class="years">
      ${years.map(y=>`<button class="year-btn" data-year="${y}">${y}</button>`).join('')}
    </div>
    <div id="benef-table"></div>
  `;
  container.querySelectorAll('.year-btn').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      container.querySelectorAll('.year-btn').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      const ano = btn.dataset.year;
      const rows = BENEF[ano] || [];
      document.getElementById('benef-table').innerHTML = tableBenef(rows);
    });
  });
  const lastBtn = container.querySelector(`.year-btn[data-year="${last}"]`);
  if(lastBtn) lastBtn.click();
}
async function ensureBenef(){
  if(BENEF) return true;
  try{
    const res = await fetch('beneficios.json', {cache: 'no-store'});
    if(!res.ok) throw new Error('HTTP '+res.status);
    BENEF = await res.json();
    return true;
  }catch(e){
    const container = document.getElementById('benef-container');
    if(container){
      container.innerHTML = '<div class="empty">Não foi possível carregar o <code>beneficios.json</code>. Coloque o arquivo na mesma pasta desta página.</div>';
    }
    return false;
  }
}
// Aciona quando o usuário escolhe o menu "Benefício Concedido"
document.querySelectorAll('.menu-btn[data-section="beneficio"]').forEach(btn=>{
  btn.addEventListener('click', async ()=>{
    if(await ensureBenef()){
      renderBenefYears();
    }
  });
});

</script>

</body>
</html>
