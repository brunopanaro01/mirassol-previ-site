<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Aposentadorias — Mirassol-Previ</title>

  <!-- Fonte -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>

  <style>
    :root{
      --brand-900:#01385f; --brand-800:#014c85; --brand-700:#03588c;
      --bg:#f7fafc; --paper:#ffffff; --ink:#0f172a; --muted:#475569;
      --line:#e2e8f0; --soft:#f3f7fb; --shadow:0 10px 30px rgba(2,8,23,.08);
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--ink);line-height:1.6}
    a{color:var(--brand-800);text-decoration:none}
    img{max-width:100%;height:auto;display:block}

    /* Anti-popup legado */
    #popup,.popup,.modal,.modal-backdrop,[role="dialog"],.overlay,.newsletter-modal,.cookie-modal{display:none!important}
    body.modal-open{overflow:auto!important}

    /* ================= HEADER (padrão da index) ================= */
    header.site-header{position:sticky;top:0;z-index:100;background:#fff;border-bottom:1px solid var(--line)}
    .header-wrap{max-width:1200px;margin:0 auto;padding:10px 16px;display:flex;align-items:center;gap:16px}
    .brand{display:flex;align-items:center;gap:12px}
    .brand img{width:52px;height:52px}
    .brand .titles{display:flex;flex-direction:column}
    .brand .titles h1{margin:0;font-size:20px;color:var(--brand-800)}
    .brand .titles small{font-size:12px;color:var(--muted)}

    nav.primary{margin-left:auto;position:relative}
    .menu{display:flex;gap:8px;align-items:center}
    .menu a,.menu button{padding:10px 12px;border-radius:10px;color:var(--ink);background:transparent;border:0;font:inherit;cursor:pointer}
    .menu a:hover,.menu button:hover{background:#eef5fb}
    .menu a.active{background:#eef5fb}
    .hamb{display:none;background:none;border:0;padding:8px;border-radius:10px}

    /* Submenu Institucional */
    .has-sub{position:relative}
    .has-sub > button{display:inline-flex;align-items:center;gap:6px}
    .submenu{
      display:none;position:absolute;top:100%;left:0;z-index:101;
      background:#fff;border:1px solid var(--line);border-radius:12px;box-shadow:var(--shadow);
      min-width:260px;padding:6px
    }
    .submenu a{display:block;padding:10px 12px;border-radius:8px}
    .submenu a:hover{background:var(--soft)}
    /* Desktop: abre no hover/focus */
    .has-sub:hover .submenu,
    .has-sub:focus-within .submenu{display:block}

    /* ================= LAYOUT DA PÁGINA ================= */
    main.section{padding:40px 16px}
    .container{max-width:1200px;margin:0 auto}
    .grid{display:grid;grid-template-columns:280px 1fr;gap:22px}
    @media(max-width:980px){.grid{grid-template-columns:1fr}}

    /* Sidebar */
    .side{background:#fff;border:1px solid var(--line);border-radius:16px;box-shadow:var(--shadow);height:max-content}
    .side h3{margin:0;padding:14px 16px;background:var(--brand-800);color:#fff;border-radius:16px 16px 0 0;font-size:16px}
    .side .note{padding:10px 16px;font-size:12px;color:var(--muted);border-bottom:1px solid var(--line)}
    .side .tabs{display:flex;flex-direction:column}
    .side .tabs button{
      padding:12px 16px;text-align:left;background:#fff;border:0;border-top:1px solid var(--line);
      font-weight:600;cursor:pointer;border-radius:0 0 16px 16px
    }
    .side .tabs button.active{background:var(--soft);color:#0f172a}

    /* Conteúdo */
    .content .card{
      background:var(--paper);border:1px solid var(--line);border-radius:16px;box-shadow:var(--shadow);margin-bottom:20px
    }
    .card-pad{padding:20px}
    h1.page-title{margin:0 0 10px;font-size:clamp(1.6rem,1.1rem + 1.2vw,2.2rem);color:var(--brand-900)}
    .page-lead{margin:6px 0 18px;color:var(--muted)}
    h2{color:var(--brand-900);margin:0 0 10px}

    /* Accordion de Regras */
    .accordion .item{border-top:1px solid var(--line)}
    .accordion .head{
      background:var(--brand-800);color:#fff;padding:14px 16px;cursor:pointer;position:relative;font-weight:600
    }
    .accordion .head::after{content:"+";position:absolute;right:16px;top:50%;transform:translateY(-50%);font-size:20px}
    .accordion .head.active::after{transform:translateY(-50%) rotate(45deg)}
    .accordion .body{max-height:0;overflow:hidden;transition:max-height .35s ease;background:#f8fafc;padding:0 16px}
    .accordion .body-inner{padding:12px 0}
    table{width:100%;border-collapse:collapse;margin-top:12px;font-size:14px;background:#fff}
    th,td{border:1px solid var(--line);padding:8px;text-align:left}
    th{background:#eef2f7}

    /* Benefício Concedido */
    .years{display:flex;flex-wrap:wrap;gap:8px;margin:6px 0 12px}
    .year-btn{padding:8px 12px;border:1px solid var(--line);border-radius:8px;background:#fff;cursor:pointer;font-weight:600}
    .year-btn.active{background:var(--brand-800);color:#fff;border-color:var(--brand-800)}
    .tabela{width:100%;border-collapse:collapse;background:#fff}
    .tabela th,.tabela td{border:1px solid var(--line);padding:8px}
    .tabela th{background:#eef2f7}

    /* Memórias */
    .table{width:100%;border-collapse:collapse}
    .table th,.table td{border:1px solid var(--line);padding:10px;text-align:left;vertical-align:top}
    .table th{background:#f3f6fb}

    /* Rodapé central */
    footer.site-footer{background:#0d2636;color:#cbd5e1;margin-top:40px}
    .footer-wrap{max-width:1200px;margin:0 auto;padding:20px 16px;text-align:center}
    .back{display:inline-block;margin-top:8px;padding:8px 14px;background:var(--brand-800);color:#fff;border-radius:8px}
    .back:hover{opacity:.9}

    /* Scroll reveal */
    .reveal{opacity:0;transform:translateY(14px);transition:opacity .5s ease,transform .5s ease}
    .reveal.in{opacity:1;transform:none}

    /* Mobile menu */
    @media(max-width:860px){
      .menu{display:none;position:absolute;top:64px;right:16px;background:#fff;border:1px solid var(--line);box-shadow:var(--shadow);padding:8px;border-radius:12px;flex-direction:column;min-width:280px}
      .menu.show{display:flex}
      .hamb{display:inline-grid;place-items:center}
      .brand .titles h1{font-size:18px}
      .brand img{width:44px;height:44px}
      .has-sub .submenu{position:static;box-shadow:none;border:0;padding:0;margin-left:8px;margin-bottom:8px;display:none}
      .has-sub.open .submenu{display:block}
    }
  </style>
</head>

<body>
  <!-- ================= HEADER (padrão da index) ================= -->
  <header class="site-header" role="banner">
    <div class="header-wrap">
      <a class="brand" href="./index.html" aria-label="Ir para a página inicial">
        <img src="brasao.png" alt="Brasão de Mirassol D'Oeste"/>
        <span class="titles">
          <h1>Mirassol-Previ</h1>
          <small>Fundo Municipal de Previdência Social — Mirassol D’Oeste/MT</small>
        </span>
      </a>

      <button class="hamb" aria-label="Abrir menu" aria-controls="menu" aria-expanded="false">
        <svg width="26" height="26" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>

      <nav class="primary" aria-label="Menu principal">
        <div id="menu" class="menu" role="menubar">
          <a role="menuitem" href="./index.html">Início</a>
          <div class="has-sub" role="none">
            <button aria-haspopup="true" aria-expanded="false">Institucional ▾</button>
            <div class="submenu" role="menu">
              <a role="menuitem" href="historia.html">História</a>
              <a role="menuitem" href="identidade.html">Identidade</a>
              <a role="menuitem" href="composicao.html">Composição</a>
              <a role="menuitem" href="organograma.html">Organograma</a>
            </div>
          </div>
          <a class="active" role="menuitem" href="aposentadorias.html">Aposentadorias</a>
          <a role="menuitem" href="transparencia.html">Transparência</a>
          <a role="menuitem" href="progestao.html">Pró-Gestão</a>
          <a role="menuitem" href="https://mirassoldoeste.flowdocs.com.br:2053/public/home/group/5" target="_blank" rel="noopener">Ouvidoria</a>
        </div>
      </nav>
    </div>
  </header>

  <!-- ================= CONTEÚDO ================= -->
  <main class="section">
    <div class="container">
      <header class="reveal">
        <h1 class="page-title">Aposentadorias</h1>
        <p class="page-lead">Regras, benefícios concedidos e memórias dos servidores.</p>
      </header>

      <div class="grid">
        <!-- Sidebar -->
        <aside class="side reveal" aria-label="Navegação interna">
          <h3>Aposentadorias</h3>
          <div class="note">Obs.: arquivos externos abrem em nova aba.</div>
          <div class="tabs">
            <button class="active" data-section="regras">Regras de Aposentadoria</button>
            <button data-section="beneficio">Benefício Concedido</button>
            <button data-section="memorias">Memórias</button>
          </div>
        </aside>

        <!-- Conteúdo -->
        <div class="content">
          <!-- Regras -->
          <section id="sec-regras" class="card reveal">
            <div class="card-pad">
              <h2>Regras de Aposentadoria</h2>
              <div class="accordion">
                <div class="item">
                  <div class="head">1ª Regra – Idade e Tempo de Contribuição</div>
                  <div class="body"><div class="body-inner">
                    <p><strong>Aplicável:</strong> Servidores ingressados após 31/12/2003, ou que não optaram pelas regras de transição.</p>
                    <p><strong>Regra permanente (Art. 40, §1º, III, a):</strong></p>
                    <table>
                      <tr><th>Requisito</th><th>Homem</th><th>Mulher</th></tr>
                      <tr><td>Tempo de contribuição</td><td>35 anos</td><td>30 anos</td></tr>
                      <tr><td>Idade mínima</td><td>60 anos</td><td>55 anos</td></tr>
                      <tr><td>Tempo de serviço público</td><td>10 anos</td><td>10 anos</td></tr>
                      <tr><td>Tempo no cargo</td><td>5 anos</td><td>5 anos</td></tr>
                    </table>
                    <p><strong>Cálculo:</strong> média da Lei 10.887/2004; teto = remuneração do cargo efetivo; sem paridade.</p>
                    <p><strong>Reajuste:</strong> Sem paridade; segue índices/data do RGPS.</p>
                  </div></div>
                </div>

                <div class="item">
                  <div class="head">2ª Regra – Direito Adquirido</div>
                  <div class="body"><div class="body-inner">
                    <p>Para quem cumpriu os requisitos de aposentadoria até 31/12/2003, valem as regras anteriores à EC nº 41/2003, com paridade e integralidade.</p>
                  </div></div>
                </div>

                <div class="item">
                  <div class="head">3ª Regra – Transição EC 41/2003</div>
                  <div class="body"><div class="body-inner">
                    <p>Para ingressados até 31/12/2003 que não completaram os requisitos à época. Prevê pedágio de 20% sobre o tempo faltante; garante paridade e integralidade.</p>
                  </div></div>
                </div>

                <div class="item">
                  <div class="head">4ª Regra – Aposentadoria Compulsória</div>
                  <div class="body"><div class="body-inner">
                    <p><strong>Base legal:</strong> LC nº 152/2015 - Art. 40, §1º, CF.</p>
                    <p><strong>Idade mínima:</strong> 75 anos. Proventos proporcionais ao tempo de contribuição.</p>
                  </div></div>
                </div>
              </div>
            </div>
          </section>

          <!-- Benefício Concedido -->
          <section id="sec-beneficio" class="card reveal" style="display:none">
            <div class="card-pad">
              <h2>Benefício Concedido</h2>
              <p class="page-lead" style="margin-top:0">Distribuição por ano — colunas: <em>Mês</em>, <em>Descrição</em> e <em>Arquivo</em>.</p>
              <div id="benef-container">Carregando dados…</div>
            </div>
          </section>

          <!-- Memórias -->
          <section id="sec-memorias" class="card reveal" style="display:none">
            <div class="card-pad">
              <h2>Memórias</h2>
              <p>Relatos orais e documentais dos servidores aposentados que fizeram parte do quadro de Mirassol d’Oeste — fotos, imagens e documentos (mediante autorização).</p>
              <table class="table" id="tabelaMemorias">
                <thead><tr><th style="width:65%">Descrição</th><th>Arquivo</th></tr></thead>
                <tbody><tr><td colspan="2">Carregando...</td></tr></tbody>
              </table>
            </div>
          </section>
        </div>
      </div>

      <div class="reveal" style="text-align:center;margin-top:8px">
        <a class="back" href="index.html">← Voltar à página inicial</a>
      </div>
    </div>
  </main>

  <!-- ================= RODAPÉ ================= -->
  <footer class="site-footer" role="contentinfo">
    <div class="footer-wrap">
      <span>© <span id="year"></span> Mirassol-Previ</span>
    </div>
  </footer>

  <script>
    // Ano dinâmico no rodapé
    document.getElementById('year').textContent = new Date().getFullYear();

    // Menu mobile
    const hamb = document.querySelector('.hamb');
    const menu = document.getElementById('menu');
    hamb?.addEventListener('click', ()=>{
      const open = menu.classList.toggle('show');
      hamb.setAttribute('aria-expanded', String(open));
    });
    document.querySelectorAll('.has-sub > button').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const parent = btn.closest('.has-sub');
        const isOpen = parent.classList.toggle('open');
        btn.setAttribute('aria-expanded', String(isOpen));
      });
    });

    // Tabs da sidebar
    const tabBtns = document.querySelectorAll('.side .tabs button');
    tabBtns.forEach(btn=>{
      btn.addEventListener('click', async ()=>{
        tabBtns.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        const sec = btn.dataset.section;
        document.getElementById('sec-regras').style.display = (sec==='regras') ? '' : 'none';
        document.getElementById('sec-beneficio').style.display = (sec==='beneficio') ? '' : 'none';
        document.getElementById('sec-memorias').style.display = (sec==='memorias') ? '' : 'none';
        if(sec==='beneficio'){ if(await ensureBenef()){ renderBenefYears(); } }
        if(sec==='memorias'){ carregarMemorias(); }
        window.scrollTo({top:0,behavior:'smooth'});
      });
    });

    // Accordion de Regras
    document.querySelectorAll('.accordion .head').forEach(h=>{
      h.addEventListener('click', ()=>{
        h.classList.toggle('active');
        const body = h.nextElementSibling;
        if(body.style.maxHeight){ body.style.maxHeight=null; }
        else { body.style.maxHeight = body.scrollHeight + 'px'; }
      });
    });

    // ====== Benefício Concedido: carrega beneficios.json ======
    let BENEF = null;
    async function ensureBenef(){
      if(BENEF) return true;
      try{
        const res = await fetch('beneficios.json', {cache:'no-store'});
        if(!res.ok) throw new Error('HTTP '+res.status);
        BENEF = await res.json();
        return true;
      }catch(e){
        const container = document.getElementById('benef-container');
        container.innerHTML = '<div class="page-lead">Não foi possível carregar <code>beneficios.json</code>. Coloque o arquivo na mesma pasta desta página.</div>';
        return false;
      }
    }
    function tableBenef(rows){
      if(!rows || rows.length===0){ return '<div class="page-lead">Nenhum registro neste ano.</div>'; }
      return `
        <table class="tabela">
          <thead><tr><th style="width:120px">Mês</th><th>Descrição</th><th style="width:180px">Arquivo</th></tr></thead>
          <tbody>
            ${rows.map(r=>`
              <tr>
                <td>${r.mes||''}</td>
                <td>${r.descricao||''}</td>
                <td>${r.link?`<a href="${r.link}" target="_blank" rel="noopener">Baixar arquivo</a>`:'-'}</td>
              </tr>
            `).join('')}
          </tbody>
        </table>
      `;
    }
    function renderBenefYears(){
      const container = document.getElementById('benef-container');
      const years = Object.keys(BENEF||{}).sort();
      if(years.length===0){ container.innerHTML = '<div class="page-lead">Não há anos cadastrados.</div>'; return; }
      const last = years[years.length-1];
      container.innerHTML = `
        <div class="years">${years.map(y=>`<button class="year-btn" data-year="${y}">${y}</button>`).join('')}</div>
        <div id="benef-table"></div>
      `;
      container.querySelectorAll('.year-btn').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          container.querySelectorAll('.year-btn').forEach(b=>b.classList.remove('active'));
          btn.classList.add('active');
          const ano = btn.dataset.year;
          document.getElementById('benef-table').innerHTML = tableBenef(BENEF[ano]||[]);
        });
      });
      container.querySelector(`.year-btn[data-year="${last}"]`)?.click();
    }

    // ====== Memórias: carrega memorias.json ======
    async function carregarMemorias(){
      try{
        const res = await fetch('memorias.json', {cache:'no-store'});
        if(!res.ok) throw new Error();
        const dados = await res.json();
        const tbody = document.querySelector('#tabelaMemorias tbody');
        tbody.innerHTML = (Array.isArray(dados) && dados.length)
          ? dados.map(i=>`
              <tr>
                <td>${i.descricao||''}</td>
                <td>${i.link?`<a href="${i.link}" target="_blank" rel="noopener">Baixar arquivo</a>`:'-'}</td>
              </tr>
            `).join('')
          : '<tr><td colspan="2">Nenhum item cadastrado ainda.</td></tr>';
      }catch{
        const tbody = document.querySelector('#tabelaMemorias tbody');
        tbody.innerHTML = '<tr><td colspan="2">Não foi possível carregar <code>memorias.json</code>.</td></tr>';
      }
    }

    // Scroll reveal
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{
        if(e.isIntersecting){ e.target.classList.add('in'); io.unobserve(e.target); }
      });
    }, {threshold:.12});
    document.querySelectorAll('.reveal').forEach(el=> io.observe(el));
  </script>
</body>
</html>
