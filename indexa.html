<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mirassol-Previ — Fundo Municipal de Previdência</title>
  <meta name="description" content="Site oficial do Mirassol-Previ — Fundo Municipal de Previdência Social dos Servidores de Mirassol D’Oeste - MT."/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --brand-900:#01385f;
      --brand-800:#014c85;
      --brand-700:#03588c;
      --bg:#f7fafc;
      --paper:#ffffff;
      --ink:#0f172a;
      --muted:#475569;
      --shadow:0 10px 30px rgba(2,8,23,.08);
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,sans-serif;background:var(--bg);color:var(--ink)}
    img{max-width:100%;height:auto;display:block}
    #popup, .popup, .modal, .modal-backdrop, [role="dialog"], .overlay, .newsletter-modal, .cookie-modal { display:none !important; }
    body.modal-open { overflow:auto !important; }

    header.site-header{position:sticky;top:0;z-index:100;background:#fff;border-bottom:1px solid #e2e8f0}
    .header-wrap{max-width:1200px;margin:0 auto;padding:10px 16px;display:flex;align-items:center;gap:16px}
    .brand{display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit}
    .brand img{width:52px;height:52px}
    .brand .titles h1{font-size:20px;margin:0;color:var(--brand-800)}
    .brand .titles small{font-size:12px;color:var(--muted)}

    .hero{background:linear-gradient(180deg,#fff,#f5f9fc 65%)}
    .hero .wrap{max-width:1200px;margin:0 auto;padding:56px 16px;display:grid;grid-template-columns:1.1fr .9fr;gap:32px;align-items:center}
    .hero h2{font-size:34px;margin:0 0 10px;color:var(--brand-900)}
    .hero p{color:var(--muted);margin:0 0 10px;max-width:56ch}
    .hero .wrap img.hero-img{max-width:320px;border-radius:16px;box-shadow:0 6px 20px rgba(0,0,0,.15);margin-left:auto}
    @media(max-width:980px){.hero .wrap{grid-template-columns:1fr}.hero .wrap img.hero-img{margin:20px auto 0}}

    .cta{display:flex;gap:12px;margin-top:20px}
    .btn{appearance:none;border:0;padding:12px 16px;border-radius:12px;font-weight:600;cursor:pointer}
    .btn.primary{background:var(--brand-800);color:#fff}
    .btn.primary:hover{background:var(--brand-700)}
    .btn.ghost{background:#eef5fb;color:var(--brand-800)}

    .kpis{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:24px}
    .kpi{background:var(--paper);border-radius:12px;box-shadow:var(--shadow);padding:16px;text-align:center}
    .kpi b{font-size:26px;color:var(--brand-900)}
    .kpi span{display:block;color:var(--muted);font-size:12px}

    section{padding:56px 16px}
    .container{max-width:1200px;margin:0 auto}
    h2.section-title{font-size:28px;color:var(--brand-900);margin:0 0 24px}

    table#tabela-numeros thead th{position:sticky;top:0}
    table#tabela-numeros tbody tr:nth-child(odd){background:#fafcff}
    table#tabela-numeros th, table#tabela-numeros td{padding:12px 14px;text-align:center}
    table#tabela-numeros th:first-child, table#tabela-numeros td:first-child{text-align:left}

    footer.site-footer{background:#0d2636;color:#cbd5e1;padding:20px}
    .footer-wrap{max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between}
    .foot-note{font-size:13px}
  </style>
</head>
<body>
  <header class="site-header">
    <div class="header-wrap">
      <a class="brand" href="./index.html" aria-label="Ir para a página inicial">
        <img src="brasao.png" alt="Brasão de Mirassol D'Oeste"/>
        <span class="titles">
          <h1>Mirassol-Previ</h1>
          <small>Fundo Municipal de Previdência Social — Mirassol D’Oeste/MT</small>
        </span>
      </a>
    </div>
  </header>

  <section class="hero">
    <div class="wrap container">
      <div>
        <h2>Transparência, segurança e serviço ao segurado</h2>
        <p>Acompanhe notícias, documentos oficiais, dados de aposentadorias e pensões e acesse nossos serviços digitais.</p>
        <div class="cta">
          <a class="btn primary" href="http://www.agendadatacenter.com.br/portalMirassoldoEste/Login/Login.aspx" target="_blank" rel="noopener">Portal do Segurado</a>
          <a class="btn ghost" href="#numeros">Ver números</a>
        </div>
        <div class="kpis">
          <div class="kpi"><b id="kpi-aposentados">—</b><span>Aposentados</span></div>
          <div class="kpi"><b id="kpi-pensionistas">—</b><span>Pensionistas</span></div>
        </div>
      </div>
      <div>
        <img src="brasao.png" alt="Imagem institucional Mirassol-Previ" class="hero-img"/>
      </div>
    </div>
  </section>

  <section id="numeros">
    <div class="container">
      <h2 class="section-title">Números de Aposentadorias e Pensões</h2>
      <div style="overflow-x:auto">
        <table id="tabela-numeros" style="width:100%;background:#fff;border-radius:12px;box-shadow:var(--shadow);border-collapse:collapse">
          <thead style="background:var(--brand-800);color:#fff">
            <tr id="thead-row"></tr>
          </thead>
          <tbody id="tbody-numeros"></tbody>
        </table>
      </div>
      <p id="sheet-status" style="color:var(--muted);font-size:13px;margin-top:10px">Carregando dados…</p>
    </div>
  </section>

  <footer class="site-footer">
    <div class="footer-wrap">
      <span class="foot-note">© <span id="year"></span> Mirassol-Previ</span>
      <a class="foot-note" href="#top">Voltar ao topo</a>
    </div>
  </footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    async function fetchDados(){
      const status = document.getElementById('sheet-status');
      try{
        const res = await fetch('./dados.json', {cache: 'no-store'});
        const json = await res.json();
        renderKPIs(json);
        renderTable(json);
        status.textContent = 'Dados carregados de dados.json (local).';
      }catch(e){
        console.warn('Erro ao carregar dados.json', e);
        status.textContent = 'Não foi possível carregar dados.json.';
      }
    }

    function lastValue(obj){
      const anos = Object.keys(obj||{}).sort();
      for(let i=anos.length-1;i>=0;i--){
        const raw = obj[anos[i]];
        const n = Number(String(raw ?? '').replace(/\./g,'').replace(',','.'));
        if(Number.isFinite(n)) return n;
      }
      return null;
    }

    function renderKPIs(data){
      const a = lastValue(data.aposentados||{});
      const p = lastValue(data.pensionistas||{});
      if(a!=null) document.getElementById('kpi-aposentados').textContent = String(a);
      if(p!=null) document.getElementById('kpi-pensionistas').textContent = String(p);
    }

    function renderTable(data){
      const thead = document.getElementById('thead-row');
      const tbody = document.getElementById('tbody-numeros');
      thead.innerHTML = ''; tbody.innerHTML = '';

      const anos = Object.keys(data.aposentados||{}).sort();

      const thCat = document.createElement('th');
      thCat.textContent = 'Categoria';
      thCat.style.padding='14px 16px'; thCat.style.textAlign='left';
      thead.appendChild(thCat);
      anos.forEach(ano=>{
        const th = document.createElement('th');
        th.textContent = ano;
        th.style.padding='14px 12px'; th.style.textAlign='center';
        thead.appendChild(th);
      });

      const trA = document.createElement('tr');
      const thA = document.createElement('th');
      thA.textContent = 'Aposentados'; thA.style.background='#f1f5f9'; thA.style.color='var(--brand-900)'; thA.style.textAlign='left';
      trA.appendChild(thA);
      anos.forEach(ano=>{
        const td = document.createElement('td');
        td.textContent = data.aposentados?.[ano] ?? '';
        td.style.textAlign='center';
        trA.appendChild(td);
      });
      tbody.appendChild(trA);

      const trP = document.createElement('tr');
      const thP = document.createElement('th');
      thP.textContent = 'Pensionistas'; thP.style.background='#f1f5f9'; thP.style.color='var(--brand-900)'; thP.style.textAlign='left';
      trP.appendChild(thP);
      anos.forEach(ano=>{
        const td = document.createElement('td');
        td.textContent = data.pensionistas?.[ano] ?? '';
        td.style.textAlign='center';
        trP.appendChild(td);
      });
      tbody.appendChild(trP);
    }

    fetchDados();
  </script>
</body>
</html>
